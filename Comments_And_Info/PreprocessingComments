This Python script preprocesses GALEX telescope imaging data by filtering out low-quality images and applying various corrections to the data. It takes command-line arguments for batch number, index, and coordinates to locate the appropriate data directory, then uses multiprocessing to efficiently handle multiple files in parallel. The core functionality begins with the preprocess function, which first reprojects the flags file from its native size to match the size of the other images, then calculates what fraction of pixels within a 1400-pixel radius circle are flagged as bad. If this fraction exceeds 20%, the entire set of files is discarded as too corrupted to use. For files that pass this quality check, the script applies specific preprocessing steps to each file type: count maps have pixels outside the circular region replaced with NaN values, relative response files have negative values replaced with NaNs, and intensity files have negative values replaced with NaNs and are smoothed with a Gaussian filter having a full width at half maximum of 7 pixels. All processed files are then trimmed to focus on the central circular region, reducing the image size. The processed data is saved with a "_preprocessed" suffix added to the original filename, while the reprojected flags files are saved with a "_wcs" suffix, and files are processed in parallel using all available CPU cores allocated by the SLURM job scheduler.
