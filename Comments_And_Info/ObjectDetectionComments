This Python script performs automated detection and removal of large extended sources and point sources from GALEX ultraviolet imaging data. The script takes command line arguments for batch number, index, and coordinates to locate the preprocessed data, then uses multiprocessing to handle multiple files in parallel. The workflow consists of two main stages implemented through the segmentation and starfinder_new functions. In the first stage, the segmentation function detects large extended sources like galaxies using image segmentation techniques. Once these large sources are identified, the function removes them by filling in the segmented regions with Poisson noise that matches the statistical properties of the surrounding sky background, effectively creating a smooth field where the sources once were. In the second stage, the starfinder_new function detects point sources like stars in the cleaned intensity images using a point spread function finder. The function saves three outputs for each processed image: a pickle file containing the list of coordinates for all detected point sources, a masked intensity image with stars removed, and a binary mask showing the locations of the masked regions. Throughout both stages, pixels flagged as bad in the flags file are properly handled and excluded from the analysis, ensuring that artifacts and corrupted data do not interfere with source detection.
